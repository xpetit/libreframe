-------------------------------------------------------------------------------
--                  _           
--  |  . |_   _ _  |_  _ _   _ _   _  
--  |_ | |_) | (/_ |  | (_| | | | (/_ 
--
--  @file      libreframe.gpr
--  @copyright See authors list below and README.md file
--  @licence   LGPL v3
--  @encoding  UTF-8
-------------------------------------------------------------------------------
--  @summary
--  LibreFrame framework
--
--  @description
--  All specified paths are relative to the root directory project.
--
--  @authors
--  Stéphane Rivière - sr - dev@soweb.io
--  Xavier Petit - xp - dev@soweb.io
--
--  @versions
--  See git log
-------------------------------------------------------------------------------

with "config/libreframe_config.gpr";

project LibreFrame is

   for Languages use ("Ada", "C");
   for Source_Dirs use ("tests/api/**", "lib/**");
   --for Source_Dirs use ("tests/**", "lib/**");

   for Create_Missing_Dirs use "True";
   for Object_Dir use "obj/" & libreframe_Config.Build_Profile;
   for Exec_Dir use "bin";
   
   for Main use ("testapi"); --, "web");
   
   ----------------------------------------------------------------------------
   --  Compiler options (Gnat)
   ----------------------------------------------------------------------------

   package Compiler is
      for Default_Switches ("Ada") use libreframe_Config.Ada_Compiler_Switches;
      for Switches ("s-memory.adb") use ("-gnatg");    
      for Local_Configuration_Pragmas use "pragmas.adc";
   end Compiler;

   ----------------------------------------------------------------------------
   --  Binder options (gnatbind)
   ----------------------------------------------------------------------------

   package Binder is
      --  -Es: Store tracebacks in exception occurrences, and enable symbolic tracebacks
      for Default_Switches ("Ada") use ("-Es");
   end Binder;

   ----------------------------------------------------------------------------
   --  Linker options (ld)
   ----------------------------------------------------------------------------

   Common_Linker_Options := (""); -- -static : program statically linked
   
   --  MySQL handling
   Common_Linker_Options := Common_Linker_Options & ("-lmysqlclient"); 
   
   --  PostgreSQL handling
   Common_Linker_Options := Common_Linker_Options & ("-lpq"); 
   
   --  Firebird handling
   Common_Linker_Options := Common_Linker_Options & ("-lfbclient"); 

   package Linker is
      for Default_Switches ("ada") use Common_Linker_Options & ("-g");
   end Linker;

  -----------------------------------------------------------------------------
  --  Builder options (gprbuild)
  -----------------------------------------------------------------------------

   package Builder is
      -- -d   Display compilation process
      -- -j0  Use num processes to compile 0=all platform cores are used
      -- -s   Recompile if compiler switches have changed
      for Default_Switches ("ada") use ("-j0", "-s");
   end Builder;

   ----------------------------------------------------------------------------
   --  Document options (gnatdoc)
   ----------------------------------------------------------------------------

   package Documentation is
      for Documentation_Dir use "doc-generated";
   end Documentation;

   ----------------------------------------------------------------------------
   --  Printer options (gnatpp)
   ----------------------------------------------------------------------------

   package Pretty_Printer is
      for Default_Switches ("ada") use ("-M120", "-W8", "--comments-unchanged");
   end Pretty_Printer;

------------------------------------------------------------------------------
end LibreFrame;
------------------------------------------------------------------------------

